 Running search tool...
[{'title': 'Riyadh: The Capital of Saudi Arabia - Flag Match', 'url': 'https://flagmatch.com/capitals/riyadh', 'content': 'CountryðŸ‡¸ðŸ‡¦ Saudi Arabia\nPopulation 7,009,120 (2020 estimate)\nCoordinates 24.7136Â° N, 46.6753Â° E\nArea 3,115 kmÂ² (1,200 sq mi)\nClimate Hot desert climate (KÃ¶ppen climate classification BWh)\nLanguage Arabic (official), English (widely spoken)\nCurrency Saudi riyal (SAR)\nTime zone Arabia Standard Time (UTC+3)\nProximity to other major cities Mecca (770 km / 478 mi), Jeddah (850 km / 530 mi), Dubai (1,160 km / 720 mi)\n\nInteresting facts about Riyadh\n------------------------------', 'score': 0.87782305}, {'title': 'Saudi Arabia Flag Coloring Page | Fun and Educational Activity', 'url': 'https://www.planerium.com/shop/coloring-pages/saudi-arabia-flag-coloring-page/?srsltid=AfmBOopIgVzRhLR0UJqytgBtX-XK8eiEvQr4bn8NOElMJ9iVL4tGF046', 'content': 'Learn more about Saudi Arabia on Wikipedia. Flag Colors: Green. White. Coordinates: 24.7136Â° N, 46.6753Â° E.', 'score': 0.735737}, {'title': 'What is the absolute location (coordinates) of the Middle East?', 'url': 'https://www.studocu.com/en-us/messages/question/3570409/what-is-the-absolute-location-coordinates-of-the-middle-east', 'content': '| City | Country | Latitude | Longitude |\n| --- | --- | --- | --- |\n| Riyadh | Saudi Arabia | 24.7136Â° N | 46.6753Â° E |\n| Tehran | Iran | 35.6892Â° N | 51.3890Â° E |\n| Istanbul | Turkey | 41.0082Â° N | 28.9784Â° E |\n| Jerusalem | Israel | 31.7683Â° N | 35.2137Â° E |\n| Cairo | Egypt | 30.0444Â° N | 31.2357Â° E |\n\nPlease note that these coordinates are approximate and may vary slightly depending on the source. For more precise coordinates, you can use a reliable online map service like Google Maps.', 'score': 0.7309246}]
Invoking: `retriever_tool` with `{'query': 'anomaly detection rule for Saudi Arabia'}`

Running retriever tool...
Loading existing vector store...
/Users/zhenzhili/MASTERTHESIS/#Expert_System_Design/langda/utils/vector_store_v4.py:26: LangChainDeprecationWarning: The class `OllamaEmbeddings` was deprecated in LangChain 0.3.1 and will be removed in 1.0.0. An updated version of the class exists in the :class:`~langchain-ollama package and should be used instead. To use it run `pip install -U :class:`~langchain-ollama` and import as `from :class:`~langchain_ollama import OllamaEmbeddings``.
  self.embedding_function = OllamaEmbeddings(model="nomic-embed-text")
[(Document(id='64f3076b-8c74-4b2d-8e8b-115bda4f7418', metadata={'id': 'anmoaly_1', 'title': 'Anomaly Detection: Saudi Arabia', 'tags': ['anomaly', 'Saudi_Arabia'], 'keywords': ['overheating']}, page_content="If the user is in Saudi Arabia, check machine overheating anomaly:\n - If Temperature â‰¥ 60Â°C AND Flow rate â‰¤ 20 L/min, there's anomaly\n - number(Digit1, Temp), number(Digit2, Flow)"), 304.3736)]Based on the retrieved information, the user is located in **Saudi Arabia**, where the local language is **Arabic**. The anomaly detection rule for Saudi Arabia involves checking for machine overheating conditions.

Training  for 2 epoch(s)
Epoch 1
Iteration:  100 	s:9.3708 	Average Loss:  1.9275165069103242
Iteration:  200 	s:6.9552 	Average Loss:  2.071187013536692
Iteration:  300 	s:6.8644 	Average Loss:  2.0790148884058
Iteration:  400 	s:6.9433 	Average Loss:  1.9443278466910123
Iteration:  500 	s:6.7775 	Average Loss:  1.6909526593983173
Iteration:  600 	s:6.8824 	Average Loss:  1.0656630723178386
Epoch time:  43.85809588432312
Epoch 2
Iteration:  700 	s:6.6928 	Average Loss:  0.5345414499938488
Iteration:  800 	s:6.3959 	Average Loss:  0.3245695275068283
Iteration:  900 	s:6.4900 	Average Loss:  0.29554603438824417
Iteration:  1000 	s:6.3411 	Average Loss:  0.32263986870646477
Iteration:  1100 	s:6.3131 	Average Loss:  0.30237446377053856
Iteration:  1200 	s:6.4505 	Average Loss:  0.19802818179130555
Epoch time:  38.679178953170776

Finish Training!
call __len__ Operator: 150
         	 	Actual	  
         	 	     0	 1
Predicted	0	   136	11
         	1	     2	 1
Accuracy:  0.9133333333333333
Accuracy 0.9133333333333333
Accuracy:  0.9133333333333333






